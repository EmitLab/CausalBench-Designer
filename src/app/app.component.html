<div class="title-bar">
  <img src="assets/logo.png" alt="Logo" class="logo">
  <span class="app-title">CausalBench Designer v1.0b</span>
  <div class="title-bar-actions">
    <button class="help-btn" (click)="showHelp = true">Help</button>
    <a class="help-btn" href="https://docs.causalbench.org" target="_blank" rel="noopener noreferrer">Documentation</a>
  </div>
</div>

<!-- About Popup -->
<div class="help-popup-overlay" *ngIf="showAbout" (click)="showAbout = false">
  <div class="help-popup" (click)="$event.stopPropagation()">
    <h3>About</h3>
    <div class="help-content">
      <p><b>CausalBench Designer</b> is a context design tool for CausalBench.</p>
      <p>Version 1.0b</p>
      <p>Visit <a href="https://causalbench.org" target="_blank">causalbench.org</a> for more information.</p>
    </div>
    <button class="btn btn-primary" (click)="showAbout = false">Close</button>
  </div>
</div>

<!-- Help Popup -->
<div class="help-popup-overlay" *ngIf="showHelp" (click)="showHelp = false">
  <div class="help-popup" (click)="$event.stopPropagation()">
    <h3>Help</h3>
    <div class="help-content">
      <p>CausalBench Designer is a tool for designing contexts to be used in CausalBench. It allows you to create and edit contexts, and to export them to a variety of formats.</p>
      <p>To add a dataset, click the "Add Dataset" button and select the dataset you want to add.</p>
      <p>To add a model, click the "Add Model" button and select the model you want to add.</p>
      <p>To add a metric, click the "Add Metric" button and select the metric you want to add.</p>
      <p>After creating the context, use the "Export Context Template" button to export the context to a template file, which can be executed in CausalBench.</p>
      <p>For any further questions, please contact us at <a href="mailto:support@causalbench.org">support&#64;causalbench.org</a>.</p>
    </div>
    <button class="btn btn-primary" (click)="showHelp = false">Close</button>
  </div>
</div>

<div class="app-container">
  <!-- Token Input Component -->
  <app-token-input></app-token-input>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Sidebar -->
    <app-sidebar
      [availableDatasets]="availableDatasets"
      [availableModels]="availableModels"
      [availableMetrics]="availableMetrics"
      [currentItem]="currentItem"
      [currentItemType]="currentItemType"
      [currentDatasets]="datasets"
      [currentModels]="models"
      [currentMetrics]="metrics"
      (addDataset)="onAddDataset()"
      (addModel)="onAddModel()"
      (addMetric)="onAddMetric()"
      (addItemWithData)="onAddItemWithData($event)"
      (removeItem)="onRemoveItem()"
      (exportContext)="onExportContext()"
      (applyItem)="onApplyItem($event)">
    </app-sidebar>

    <!-- Views Container -->
    <div class="views-container">
      <!-- Dataset View -->
      <app-dataset-view
        [datasets]="datasets"
        [loading]="loadingDatasets"
        (itemSelected)="onItemSelected($event)">
      </app-dataset-view>

      <!-- Model View -->
      <app-model-view
        [models]="models"
        [loading]="loadingModels"
        (itemSelected)="onItemSelected($event)">
      </app-model-view>

      <!-- Metric View -->
      <app-metric-view
        [metrics]="metrics"
        [loading]="loadingMetrics"
        (itemSelected)="onItemSelected($event)">
      </app-metric-view>
    </div>
  </div>

  <!-- Export Dialog -->
  <app-export-dialog
    [showDialog]="showExportDialog"
    [datasets]="datasets"
    [models]="models"
    [metrics]="metrics"
    (closeDialog)="onCloseExportDialog()">
  </app-export-dialog>
</div> 